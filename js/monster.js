"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,s){for(var i=0;i<s.length;i++){var h=s[i];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(t,h.key,h)}}return function(s,i,h){return i&&t(s.prototype,i),h&&t(s,h),s}}(),Monster=function(){function t(s){_classCallCheck(this,t),this.obj=s,this.name=s.name,this.maxHp=s.maxHp,this.atk=s.atk,this.rate=s.rate,this.atr=s.atr,this.speed=s.speed,this.w=s.w,this.h=s.h,this.b=s.b,this.imgsRunAll=s.imgsRunAll,this.imgsHitAll=s.imgsHitAll,this.imgsKnockbackAll=s.imgsKnockbackAll,this.imgsDeathAll=s.imgsDeathAll,this.score=s.score,this.canAtk=!0,this.hp=this.maxHp,this.pNum=0,this.pNum2=0,this.hpNum=0,this.x=0,this.y=0,this.angle=0,this.status="run",this.img,this.powImg=new Image,this.hpImg=new Image,this.imgsRun=[],this.runNow=0,this.imgsHit=[],this.hitNow=0,this.imgsDeath=[],this.deathNow=0,this.imgsKnockback=[],this.knockbackNow=0,this.deltaY,this.deltaX,this.l,this.init()}return _createClass(t,[{key:"init",value:function(){this.born(),this.creatImgs()}},{key:"draw",value:function(){"run"===this.status&&(this.computeFn(),this.l<this.atr?this.canAtk&&(this.status="hit",this.canAtk=!1,this.reAtk()):(this.y+=this.dy,this.x+=this.dx),this.img=this.imgsRun[this.runNow],this.runNow=(this.runNow+1)%this.imgsRunAll),"death"===this.status&&(this.img=this.imgsDeath[this.deathNow],this.deathNow++,this.deathNow===this.imgsDeathAll&&(c.monSet["delete"](this),c.sNumber++,c.sScore+=this.score)),"knockback"===this.status&&(this.img=this.imgsKnockback[this.knockbackNow],this.knockbackNow++,this.y-=this.dy*c.p.nb,this.x-=this.dx*c.p.nb,this.knockbackNow===this.imgsKnockbackAll&&(this.knockbackNow=0,this.status="run")),"hit"===this.status&&(this.img=this.imgsHit[this.hitNow],this.hitNow++,this.hitNow===this.imgsHitAll&&(c.p.hp-=this.atk*c.p.coe,c.p.scratchNum=1,this.hitNow=0,this.status="run")),this.drawFn(),this.powFn(),this.showHp()}},{key:"born",value:function(){var t=Math.random(),s=Math.random();.5>=t?(.5>=s?this.x=0:this.x=c.canWidth,this.y=c.canHeight*Math.random()):(.5>=s?this.y=0:this.y=c.canHeight,this.x=c.canWidth*Math.random())}},{key:"death",value:function(){this.status="death","fox"===this.name?(au.volume=.3,au.src="../audio/fox-death.mp3"):"leopard"===this.name?(au.volume=.3,au.src="../audio/leopard-death.mp3"):"pig"===this.name?(au.volume=.5,au.src="../audio/pig-death.mp3"):"alligator"===this.name&&(au.volume=.8,au.src="../audio/alligator-death.mp3","last"===this.obj.name2&&(alert("我的大鳄鱼竟然都被你给砸死了%>_<%"),alert("厉害了word哥or姐！"),alert("作者惭愧的表示：后面的游戏内容我压根就没写    (*@ο@*)"),alert("小样，你该不会是改我js代码了吧  o(￣ヘ￣o#)"),alert("真的没改？好吧"),alert("恭喜你！通关暗号：10086。凭暗号联系作者可以得到一份神秘大礼！！！"),alert("QQ：544429676      微信：wudongda1992"),alert("再会！"),c.gameOver()))}},{key:"creatImgs",value:function(){for(var t=0;t<this.imgsRunAll;t++){var s=new Image;s.src="../img/canvas/monster/"+this.name+"/run/"+t+".png",this.imgsRun.push(s)}for(var t=0;t<this.imgsHitAll;t++){var s=new Image;s.src="../img/canvas/monster/"+this.name+"/hit/"+t+".png",this.imgsHit.push(s)}for(var t=0;t<this.imgsKnockbackAll;t++){var s=new Image;s.src="../img/canvas/monster/"+this.name+"/knockback/"+t+".png",this.imgsKnockback.push(s)}for(var t=0;t<this.imgsDeathAll;t++){var s=new Image;s.src="../img/canvas/monster/"+this.name+"/death/"+t+".png",this.imgsDeath.push(s)}this.powImg.src="../img/canvas/ico/pow.png",this.hpImg.src="../img/canvas/monster/hp.png"}},{key:"computeFn",value:function(){this.deltaY=c.p.y-this.y,this.deltaX=c.p.x-this.x,this.l=Math.sqrt(Math.pow(Math.abs(this.deltaX),2)+Math.pow(Math.abs(this.deltaY),2)),this.dy=this.speed*this.deltaY/this.l,this.dx=this.speed*this.deltaX/this.l,this.angle=Math.atan2(this.deltaY,this.deltaX)+Math.PI/2}},{key:"powFn",value:function(){if(0!==this.pNum){1===this.pNum&&(this.pNum2=0);var t=2.5*this.pNum+20;c.ctx.save(),c.ctx.translate(this.x,this.y),c.ctx.drawImage(this.powImg,-t/2,-t/2,t,t),c.ctx.restore(),this.pNum++,this.pNum>=14&&(this.pNum--,this.pNum2++,30===this.pNum2&&(this.pNum=0))}}},{key:"drawFn",value:function(){c.ctx.save(),c.ctx.translate(this.x,this.y),c.ctx.rotate(this.angle),c.ctx.drawImage(this.img,.5*-this.w,.5*-this.h,this.w,this.h),c.ctx.restore()}},{key:"showHp",value:function(){0!==this.hpNum&&(this.hp<0&&(this.hp=0),c.ctx.save(),c.ctx.translate(this.x,this.y),c.ctx.drawImage(this.hpImg,0,0,150,8,-50,-50,100,6),c.ctx.drawImage(this.hpImg,150,0,150,8,-50,-50,this.hp/this.maxHp*100,6),c.ctx.restore(),this.hpNum++,this.hpNum>=40&&(this.hpNum=0))}},{key:"reAtk",value:function(){var t=this;setTimeout(function(){t.canAtk=!0},1e3*this.rate)}}]),t}();