"use strict";function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,s){for(var h=0;h<s.length;h++){var a=s[h];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(s,h,a){return h&&t(s.prototype,h),a&&t(s,a),s}}(),Bullet=function(){function t(s,h,a){_classCallCheck(this,t),this.w=40,this.h=40,this.speed=20,this.img=new Image,this.img.src="../img/canvas/ico/bullet.png",this.cr=!1,this.ox=c.p.x,this.oy=c.p.y,this.x=this.ox,this.y=this.oy,this.nl=0,this.deltaX=(s.offsetX||s.layerX)-this.ox,this.deltaY=(s.offsetY||s.layerY)-this.oy;var i=Math.sqrt(Math.pow(Math.abs(this.deltaX),2)+Math.pow(Math.abs(this.deltaY),2));this.angle=Math.atan2(this.deltaY,this.deltaX),this.d=a,this.dx=this.speed*this.deltaX/i,this.dy=this.speed*this.deltaY/i,this.init(s),this.ms=new Set}return _createClass(t,[{key:"init",value:function(t){this.crFn(),this.vastFn(t)}},{key:"draw",value:function(){var t=!0,s=!1,h=void 0;try{for(var a,i=c.monSet[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var e=a.value;if(!this.ms.has(e)){var n=Math.sqrt(Math.pow(Math.abs(this.x-e.x),2)+Math.pow(Math.abs(this.y-e.y),2));if(n<e.b+50*c.p.thump&&e.hp>0&&(e.hpNum=1,1==this.cr?(e.hp-=c.p.damage*c.p.hurt,e.pNum=1):e.hp-=c.p.damage,this.ms.add(e),0!==c.p.nb&&(e.status="knockback"),e.hp<=0&&(this.ms["delete"](e),e.death()),0===c.p.thump))return void this.death()}}}catch(r){s=!0,h=r}finally{try{!t&&i["return"]&&i["return"]()}finally{if(s)throw h}}return this.move(),this.nl=Math.sqrt(Math.pow(Math.abs(this.x-this.ox),2)+Math.pow(Math.abs(this.y-this.oy),2)),this.nl>c.p.atr?void this.death():void this.drawFn()}},{key:"death",value:function(){c.bulSet["delete"](this)}},{key:"move",value:function(){this.x+=this.dx,this.y+=this.dy}},{key:"crFn",value:function(){if(0==this.cr){var t=Math.random();t<c.p.cri&&(this.cr=!0)}}},{key:"vastFn",value:function(t){if(this.d){var s=(t.offsetX||t.layerX)-this.ox,h=(t.offsetY||t.layerY)-this.oy,a=Math.sqrt(Math.pow(Math.abs(s),2)+Math.pow(Math.abs(h),2)),i=Math.atan2(h,s),e=i+this.d,n=a*Math.cos(e),r=a*Math.sin(e);this.ox+n,this.oy+r;this.dx=this.speed*n/a,this.dy=this.speed*r/a,this.angle=e}}},{key:"drawFn",value:function(){c.ctx.save(),c.ctx.translate(this.x,this.y),c.ctx.rotate(this.angle),c.ctx.drawImage(this.img,-this.w,.5*-this.h,this.w,this.h),c.ctx.restore()}}]),t}();