"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),Canvas=function(){function e(){_classCallCheck(this,e),this.can=document.getElementById("canvas"),this.ctx=this.can.getContext("2d"),this.canWidth=this.can.width,this.canHeight=this.can.height,this.p,this.keySet=new Set,this.bulSet=new Set,this.monSet=new Set,this.mx,this.my,this.loop,this.timer_interval_fox,this.timer_interval_leopard,this.timer_interval_pig,this.timer_interval_alligator,this.timer_timeout_leopard,this.timer_timeout_pig,this.timer_timeout_alligator,this.timer_timeout_foxBoss,this.timer_timeout_leopardBoss,this.timer_timeout_pigBoss,this.timer_timeout_alligatorBoss,this.g,this.startTime,this.sNumber=0,this.sScore=0,this.init()}return _createClass(e,[{key:"init",value:function(){this.addEvent()}},{key:"addEvent",value:function(){var t=this;this.can.addEventListener("mousemove",function(e){t.mx=e.offsetX,t.my=e.offsetY},!1),this.can.addEventListener("click",function(e){t.p.canFire&&(t.shot(e,t.p.shot),t.p.canFire=!1,t.p.reFire(),t.p.status1="atk",t.p.atkNow=0)},!1),document.addEventListener("keydown",function(e){65==e.keyCode&&t.keySet.add("l"),83==e.keyCode&&t.keySet.add("b"),68==e.keyCode&&t.keySet.add("r"),87==e.keyCode&&t.keySet.add("t")},!1),document.addEventListener("keyup",function(e){65==e.keyCode&&t.keySet["delete"]("l"),83==e.keyCode&&t.keySet["delete"]("b"),68==e.keyCode&&t.keySet["delete"]("r"),87==e.keyCode&&t.keySet["delete"]("t")},!1)}},{key:"shot",value:function(t,e){setTimeout(function(){for(var i=0;e+1>i;i++)if(0===i){var a=new Bullet(t,{});c.bulSet.add(a)}else{var a=new Bullet(t,{},.05*i),r=new Bullet(t,{},-.05*i);c.bulSet.add(a),c.bulSet.add(r)}},400)}},{key:"newPlay",value:function(){this.startTime=new Date,this.sNumber=0,this.sScore=0,this.creatP(t.count()),this.gameloop(),this.creatMonster()}},{key:"gameOver",value:function(){au1.src="",au.volume=.3,au.src="../audio/gameover.mp3",this.g=new GameOver,clearInterval(this.timer_interval_fox),clearInterval(this.timer_interval_leopard),clearInterval(this.timer_interval_pig),clearInterval(this.timer_interval_alligator),clearTimeout(this.timer_timeout_leopard),clearTimeout(this.timer_timeout_pig),clearTimeout(this.timer_timeout_alligator),clearTimeout(this.timer_timeout_foxBoss),clearTimeout(this.timer_timeout_leopardBoss),clearTimeout(this.timer_timeout_pigBoss),clearTimeout(this.timer_timeout_alligatorBoss),this.monSet.clear(),this.bulSet.clear(),this.keySet.clear(),cancelAnimationFrame(this.loop),this.ctx.clearRect(0,0,this.canWidth,this.canHeight)}},{key:"creatP",value:function(t){this.p=new Player(t)}},{key:"gameloop",value:function(){this.loop=requestAnimFrame(c.gameloop.bind(c)),this.ctx.clearRect(0,0,this.canWidth,this.canHeight);var t=!0,e=!1,i=void 0;try{for(var a,r=this.bulSet[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var o=a.value;o.draw()}}catch(n){e=!0,i=n}finally{try{!t&&r["return"]&&r["return"]()}finally{if(e)throw i}}this.p&&this.p.draw();var s=!0,l=!1,m=void 0;try{for(var u,d=this.monSet[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var o=u.value;o.draw()}}catch(n){l=!0,m=n}finally{try{!s&&d["return"]&&d["return"]()}finally{if(l)throw m}}}},{key:"creatMonster",value:function(){var t=this;setTimeout(function(){au1.src="../audio/atk-bg.mp3"},3e3),this.timer_interval_fox=setInterval(function(){for(var e=Math.ceil(2*Math.random()),i=0;e>i;i++){var a=new Monster(data.monster.fox);t.monSet.add(a)}},3e3),this.timer_timeout_leopard=setTimeout(function(){t.timer_interval_leopard=setInterval(function(){var e=new Monster(data.monster.leopard);t.monSet.add(e)},7e3)},1e4),this.timer_timeout_pig=setTimeout(function(){t.timer_interval_pig=setInterval(function(){var e=new Monster(data.monster.pig);t.monSet.add(e)},9e3)},2e4),this.timer_timeout_alligator=setTimeout(function(){t.timer_interval_alligator=setInterval(function(){var e=new Monster(data.monster.alligator);t.monSet.add(e)},13e3)},3e4),this.timer_timeout_foxBoss=setTimeout(function(){var e=new Monster(data.monster.foxBoss);t.monSet.add(e);for(var i=0;5>i;i++){var a=new Monster(data.monster.fox);t.monSet.add(a)}},6e4),this.timer_timeout_leopardBoss=setTimeout(function(){var e=new Monster(data.monster.leopardBoss);t.monSet.add(e);for(var i=0;5>i;i++){var a=new Monster(data.monster.leopard);t.monSet.add(a)}},9e4),this.timer_timeout_pigBoss=setTimeout(function(){var e=new Monster(data.monster.pigBoss);t.monSet.add(e);for(var i=0;5>i;i++){var a=new Monster(data.monster.pig);t.monSet.add(a)}},12e4),this.timer_timeout_alligatorBoss=setTimeout(function(){var e=new Monster(data.monster.alligatorBoss);t.monSet.add(e);for(var i=0;5>i;i++){var a=new Monster(data.monster.alligator);t.monSet.add(a)}},15e4)}}]),e}();